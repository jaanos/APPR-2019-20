---
title: "Poročilo pri predmetu Analiza podatkov s programom R"
author: "Lenart Zavrtanik"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
runtime: shiny
---

```{r setup, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE)
# Če želimo nastaviti pisave v PDF-ju, odkomentiramo
# in sledimo navodilom v programu.
#source("fontconfig.r", encoding="UTF-8")

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding="UTF-8")
```

```{r rstudio, echo=FALSE, results='asis'}
# Izris povezave do RStudia na Binderju
source("lib/rstudio.r", encoding="UTF-8")
```

# Analiza plač v Evropi

Analiziral bom višino povprečne neto plače v Evropi.
V analizi bom primerjal gibanje plač in BDP za obdobje 10 let, v napredni analizi pa bom podrobneje iskal povezavo med višino plač in ostalimi spremenljivkami za leto 2018. Poskušal bom ugotoviti morebitne povezave med njimi. Postavil bom par hipotez, ki jih bom tekom projekta poizkušač potrditi oziroma ovreči.

## Podatkovni viri

* Povprečne plače v Evropi: https://www.reinisfischer.com/average-salary-european-union-2018
* BDP na prebivalca v Evropi: https://ec.europa.eu/eurostat/databrowser/view/sdg_08_10/default/table?lang=en
* Povprečna starost v evropskih državah: https://en.wikipedia.org/wiki/List_of_countries_by_median_age
* Leto osamosvojitve v posameznih državah: https://en.wikipedia.org/wiki/List_of_national_independence_days
* Velikost držav: https://en.wikipedia.org/wiki/List_of_countries_and_dependencies_by_area
* Stopnja kriminala: https://www.numbeo.com/crime/rankings_by_country.jsp?title=2018&region=150
* Življenski stroški: https://www.numbeo.com/cost-of-living/rankings_by_country.jsp?title=2018&region=150

## Zasnova podatkovnega modela

Iz zgornjih spletnih strani bom pobral tabele in jih nato združil v eno tabelo. Zbral bom podatke o povprečni plači posameznih držav. V prvem stolpcu tabele bodo naštete države, v drugem neto povprečne plače. V tabelo bom prav tako vključil vse ostale zbrane podatke. Z analizo bom poizkušal ugotoviti kakšne so povezave med analiziranimi spremenljivkami z višino povprečnih plač.

## Hipoteze
Postavil sem naslednje hipoteze:

* Hipoteza 1 : Višji kot je BDP, višja je povprečna plača. 
* Hipoteza 2 : Nižja je stopnja kriminala, višja je povprečna plača.
* Hipoteza 3 : Višja je povprečna starost, višja je povprečna plača.   
* Hipoteza 4 : Države, ki so manj časa samostojne bodo imele nižje povprečne plače.
* Hipoteza 5 : Velikost države ne vpliva na višino povprečne plače.
* Hipoteza 6:  Države z višjimi povprečnimi plačami bodo imele višje povprečne življenske stroške.
* Hipoteza 7:  Nižji kot so davki, višja je povprečna plača.

***

# Obdelava, uvoz in čiščenje podatkov

```{r uvoz, echo=FALSE, message=FALSE}
source("uvoz/uvoz.r", encoding="UTF-8")
```

Uvozil sem več tabel:

1. `Tabela_place` - podatki o plačah za posamezno evropsko državo
  - `Drzava` - spremenljivka: ime države
  - `letnice;2008-2018` - spremenljivka: višina povprečne plače za posamezno leto v posamezni državi

2. `Tabela_BDP` - podatki o višini BDP per capita
  - `Drzava` - spremenljivka: ime države
  - `letnice;2008-2018` - spremenljivka: višina BDP per capita za posamezno leto v posamezni državi

3. `Tabela_davki` - podatki o davkih
  - `Drzava` - spremenljivka: ime države
  - `letnice;2008-2018` - spremenljivka: višina davkov za posamezno leto v posamezni državi
  
4. `Tabela_starost` - podatki o povprečni starosti
  - `Drzava` - spremenljivka: ime države
  - `Povprecna.starost` - spremenljivka: povprečna starost v posamezni državi
  
5. `Tabela_samostojnost` - podatki o letu osamosvojitve
  - `Drzava` - spremenljivka: ime države
  - `Leto.osamosvojitve` - spremenljivka: leto osamosvojitve za posamezno državo
  
6. `Tabela_velikost` - podatki o površini
  - `Drzava` - spremenljivka: ime države
  - `Povrsina` - spremenljivka: površina posamezne države
  
7. `Tabela_kriminal` - podatki o stopnji kriminala
  - `Drzava` - spremenljivka: ime države
  - `Stopnja.kriminala` - spremenljivka: stopnja kriminala v posamezni državi
  
8. `Tabela_stroski` - podatki o življenskih stroških
  - `Drzava` - spremenljivka: ime države
  - `Zivljenski.stroski` - spremenljivka: življenski stroški v posamezni državi

Za leto 2018 sem vse zgornje tabele združil v eno tabelo, ki sem jo poimenoval Tabela_skupna.

Spodnja tabela zajema večino podatkov, ki sem jih uporabljal tekom projekta.

```{r, echo=FALSE, message=FALSE}
  names(Tabela_skupna) <- c("Država", "Placa", "Stroški", "Starost", "Kriminal", "Neodv.", "BDP", "Povrsina", "Davki")
  Tabela_skupna <- Tabela_skupna[order(Tabela_skupna$Placa),]
  print(as.data.frame(Tabela_skupna),row.names = FALSE)
```

Podatki za plače so v evrih, Stroški in Kriminal so predstavljeni z indeksom stroškov oz. kriminala. Povprečna starost je merjena v letih, Neodvisnost države pa nam pove leto osamosvojitve države. BDP per capita je merjen v evrih, Površina v kvadratnih kilometrih, Davki pa v odstotkih.
***

# Analiza in vizualizacija podatkov

```{r vizualizacija, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
source("vizualizacija/vizualizacija.r", encoding="UTF-8")
```

Spodnji graf prikazuje gibanje povprečnih plač za obdobje 2008-2018.

```{r, echo=FALSE}
  graf_place
  zemljevid_plac()
```

Na grafu lahko vidimo, da v večini držav, z izjemo Islandije, povprečne neto plače postopno rastejo. Največji padec lahko vidimo pri Združenem Kraljestvu. Padec je bil najverjetneje posledica izstopa iz Evropske unije.

Na zemljevidu je lepo opazna razlika med bogatimi državami severne Evrope, sledijo jim države zahodne Evrope. Na drugi strani pa imamo države na vzhodu, ki imajo občutno nižje povprečne plače. Lepo je vidna ločnica po t.i. "železni zavesi".

```{r, echo=FALSE}
  graf_BDP
  zemljevid_BDP()
```

Večina držav ima zelo konstantno rast BDP, zopet je izjema Islandija, ki je zabeležila hitro gospodarsko rast, ki je bila posledica uspešne sanacije bank. Prav tako lahko pri vseh državah vidimo padec BDP leta 2009, ki je posledica hude gospodarske krize, ki je zajela Evropo.

Ponovno lahko pridemo do enakega zaključka kot pri prvem zemljevidu. Tudi tukaj je jasno razvidna razlika med bogatim severom in 'revnim' vzhodom.


Podrobneje si poglejmo gibanje višine plač in BDP za državo z najvišjo plačo (Islandija), za državo z najnižjo plačo (Bolgarija) in za Slovenijo, kjer z rdečo barvo označujemo višino povprečne neto plače, z modro pa BDP per capita.

```{r, echo=FALSE}
  graf_Islandija
  graf_Bolgarija
  graf_Slovenija
```


Pri Islandiji lahko vidimo, da plače rastejo hitreje od BDP do zadnjega leta, ko se višina plač ustali. Tudi pri Bolgariji vidimo zmerno hitro rast plač, medtem ko lahko pri Sloveniji vidimo, da je le-ta mnogo počasnejša. Eden izmed vzrokov je padec BDP v dveh zaporednih letih (2012,2013).


# Napredna analiza podatkov

```{r analiza, echo=FALSE, message=FALSE}
source("analiza/analiza.r", encoding="UTF-8")
```

*Hipoteza 1 : Višji kot je BDP, višja je povprečna plača.*

```{r, echo=FALSE, message=FALSE}
 graf_BDP

```

Iz grafa je lepo razvidna korelacija med višanjem BDP-ja in višanjem povprečnih neto plač. Manjša izjema je država z najvišjimi povprečnimi neto plačami- Islandija, to pa je posledica zelo hitre rasti plač v nekaj letih. Temu bo najverjetneje sledila tudi rast BDP. Hipotezo smo potrdili.

*Hipoteza 2 : Nižja je stopnja kriminala, višja je povprečna plača.*

```{r, echo=FALSE, message=FALSE}
 graf_kriminal

```

V prvi polovici držav z najvišjimi povprečnimi neto plačami lahko opazimo, da se z višanjem plač, stopnja kriminala manjša. Viden je pa tudi drugačen trend pri državah z nižjimi neto plačami, ki te hipoteze ne potrjuje. Prav tako so podatki dokaj razpršeni. Kljub temu da se za višje plače zdi, da bi hipoteza lahko bila pravilna jo na podlagi zbranih podatkov ne moremo potrditi.

*Hipoteza 3 : Višja je povprečna starost, višja je povprečna plača.*

```{r, echo=FALSE, message=FALSE}
 graf_starost

```

Hipotezo smo postavili na podlagi predpostavke da so države z višjimi plačami bolj razvite države, za te države pa v splošnem velja, da imajo probleme s staranjem prebivalstva. Na grafu je lepo razvidno, da se povprečna plača z višanjem starosti veča le za države, ki imajo nižje povprečne neto plače, nato pa se ta trend obrne. Hipotezo lahko torej ovržemo.

*Hipoteza 4 : Države, ki so manj časa samostojne bodo imele nižje povprečne plače.*

```{r, echo=FALSE, message=FALSE}
 graf_osamosvojitev

```

Na grafu je jasno vidna velika razpršenost. Hipotezo ovržemo.

*Hipoteza 5 : Velikost države ne vpliva na višino povprečne plače.*

```{r, echo=FALSE, message=FALSE}
 graf_povrsina

```

Na grafu ni razvidna povezava med velikostjo države in višino povprečne plače. Hipotezo potrdimo.

*Hipoteza 6 :  Države z višjimi povprečnimi plačami bodo imele višje povprečne življenske stroške.*

```{r, echo=FALSE, message=FALSE}
 graf_stroski

```

Na grafu je lepo razvidna povezava med višanjem življenskih stroškov z večanjem plač. Prav tako so odstopanja majhna. Hipotezo potrdimo.

*Hipoteza 7 :  Nižji kot so davki, višja je povprečna plača.*

```{r, echo=FALSE, message=FALSE}
 graf_davki

```

Pri državah z nižjimi plačami je lepo razvidna povezava, da imajo države z nižjimi davkami višje plače. A trend se obrne pri državah z povprečnimi neto plačami višjih od 12000€. Hipotezo ovržemo.



***

# Zaključek

Trendi v Evropi kažejo, da se višina neto plač postopoma veča do nastopa morebitnih gospodarskih kriz. Islandija je država, ki je v zadnjih letih naredila velik preskok naprej, Združeno Kraljestvo pa očitno plačuje davek izstopa države iz Evropske unije. Tekom projekta smo tudi videli direktne povezave med višanjem plač in višanjem BDPja in življenskih stroškov. Prav tako smo videli, da površina in dolžina samostojnosti države ne igrata vloge pri višinah plač. Prav tako smo videli hitrejšo rast plač pri državah z mlajšim prebivalstvom.
